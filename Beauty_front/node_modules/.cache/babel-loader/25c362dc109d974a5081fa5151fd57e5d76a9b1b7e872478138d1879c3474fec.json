{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { onMounted, ref } from \"vue\";\nimport LoginSwitch from \"@/components/LoginSwitch.vue\";\nimport { useTokenStore } from '@/stores/token';\nimport { useStateStore } from '@/stores/state';\nimport { userLoginService, userRegisterService, userCheckRoleService } from \"@/api/user\";\nimport { ElMessage } from \"element-plus\";\nimport router from \"@/router\";\nexport default {\n  __name: 'Login_Register',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const loginMode = ref(true);\n    const form_login = ref({\n      username: '',\n      password: ''\n    });\n    const rules_login = {\n      username: [{\n        require: true,\n        message: '请输入用户名',\n        trigger: 'blur'\n      }, {\n        min: 3,\n        max: 12,\n        message: '长度为3到12位',\n        trigger: 'blur'\n      }],\n      password: [{\n        require: true,\n        message: '请输入密码',\n        trigger: 'blur'\n      }, {\n        min: 9,\n        max: 16,\n        message: '长度为9到16位',\n        trigger: 'blur'\n      }]\n    };\n    const form_register = ref({\n      username: '',\n      password: '',\n      repassword: '',\n      nickname: '',\n      gender: '',\n      email: ''\n    });\n\n    //密码校验器\n    const checkRePassword = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请再次确认密码'));\n      } else if (value !== form_register.value.password) {\n        callback(new Error('请确保两次输入密码一致'));\n      } else {\n        callback();\n      }\n    };\n    const rules_register = {\n      username: [{\n        require: true,\n        message: '请输入用户名',\n        trigger: 'blur'\n      }, {\n        min: 3,\n        max: 12,\n        message: '长度为3到12位',\n        trigger: 'blur'\n      }],\n      password: [{\n        require: true,\n        message: '请输入密码',\n        trigger: 'blur'\n      }, {\n        min: 9,\n        max: 16,\n        message: '长度为9到16位',\n        trigger: 'blur'\n      }],\n      nickname: [{\n        require: true,\n        message: '请输入昵称',\n        trigger: 'blur'\n      }, {\n        min: 1,\n        max: 10,\n        message: '长度为1到10位',\n        trigger: 'blur'\n      }],\n      gender: {\n        require: true,\n        message: '请选择性别',\n        trigger: 'blur'\n      },\n      email: {\n        require: true,\n        message: '请输入email',\n        trigger: 'blur'\n      },\n      repassword: {\n        validator: checkRePassword,\n        trigger: 'blur'\n      }\n    };\n    function handleLoginMode(val) {\n      loginMode.value = val;\n    }\n    const tokenStore = useTokenStore();\n    const stateStore = useStateStore();\n    const register = async () => {\n      try {\n        let result = await userRegisterService(form_register.value);\n        ElMessage.success('注册成功');\n        router.push('/login');\n      } catch (err) {\n        console.log(err);\n      }\n    };\n    const login = async () => {\n      try {\n        let result = await userLoginService(form_login.value);\n        ElMessage.success('登录成功');\n        //将得到的token存储到pinia中\n        tokenStore.setToken(result.data);\n        await loginSta();\n        router.push('/');\n      } catch (err) {\n        console.log(err);\n      }\n    };\n    const loginSta = async () => {\n      try {\n        let res = await userCheckRoleService();\n        if (res.data !== 3) {\n          stateStore.setState(res.data);\n          router.push('/');\n        } else {\n          stateStore.setState(res.data);\n        }\n      } catch (err) {\n        if (err?.response?.status === 401) {}\n      }\n    };\n    onMounted(() => {\n      loginSta();\n    });\n    const __returned__ = {\n      loginMode,\n      form_login,\n      rules_login,\n      form_register,\n      checkRePassword,\n      rules_register,\n      handleLoginMode,\n      tokenStore,\n      stateStore,\n      register,\n      login,\n      loginSta,\n      onMounted,\n      ref,\n      LoginSwitch,\n      get useTokenStore() {\n        return useTokenStore;\n      },\n      get useStateStore() {\n        return useStateStore;\n      },\n      get userLoginService() {\n        return userLoginService;\n      },\n      get userRegisterService() {\n        return userRegisterService;\n      },\n      get userCheckRoleService() {\n        return userCheckRoleService;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      get router() {\n        return router;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","ref","LoginSwitch","useTokenStore","useStateStore","userLoginService","userRegisterService","userCheckRoleService","ElMessage","router","loginMode","form_login","username","password","rules_login","require","message","trigger","min","max","form_register","repassword","nickname","gender","email","checkRePassword","rule","value","callback","Error","rules_register","validator","handleLoginMode","val","tokenStore","stateStore","register","result","success","push","err","console","log","login","setToken","data","loginSta","res","setState","response","status"],"sources":["C:/Users/32561/Desktop/毕设仓库/beauty-front/src/views/Login_Register.vue"],"sourcesContent":["<script setup>\r\nimport {onMounted, ref} from \"vue\";\r\nimport LoginSwitch from \"@/components/LoginSwitch.vue\";\r\n\r\n\r\nconst loginMode = ref(true);\r\n\r\n\r\nconst form_login = ref({\r\n  username: '',\r\n  password: ''\r\n})\r\n\r\nconst rules_login = {\r\n  username: [{require: true, message: '请输入用户名', trigger: 'blur'},\r\n    {min: 3, max: 12, message: '长度为3到12位', trigger: 'blur'}\r\n  ],\r\n  password: [{require: true, message: '请输入密码', trigger: 'blur'},\r\n    {min: 9, max: 16, message: '长度为9到16位', trigger: 'blur'}\r\n  ]\r\n}\r\n\r\nconst form_register = ref({\r\n  username: '',\r\n  password: '',\r\n  repassword: '',\r\n  nickname: '',\r\n  gender: '',\r\n  email: ''\r\n})\r\n\r\n//密码校验器\r\nconst checkRePassword = (rule, value, callback) => {\r\n  if (value === '') {\r\n    callback(new Error('请再次确认密码'))\r\n  } else if (value !== form_register.value.password) {\r\n    callback(new Error('请确保两次输入密码一致'))\r\n  } else {\r\n    callback()\r\n  }\r\n}\r\n\r\nconst rules_register = {\r\n  username: [{require: true, message: '请输入用户名', trigger: 'blur'},\r\n    {min: 3, max: 12, message: '长度为3到12位', trigger: 'blur'}\r\n  ],\r\n  password: [{require: true, message: '请输入密码', trigger: 'blur'},\r\n    {min: 9, max: 16, message: '长度为9到16位', trigger: 'blur'}\r\n  ],\r\n  nickname: [{require: true, message: '请输入昵称', trigger: 'blur'},\r\n    {min: 1, max: 10, message: '长度为1到10位', trigger: 'blur'}\r\n  ],\r\n  gender: {require: true, message: '请选择性别', trigger: 'blur'},\r\n  email: {require: true, message: '请输入email', trigger: 'blur'},\r\n  repassword: {validator: checkRePassword, trigger: 'blur'}\r\n}\r\n\r\n\r\nfunction handleLoginMode(val) {\r\n  loginMode.value = val;\r\n}\r\n\r\nimport {useTokenStore} from '@/stores/token'\r\nimport {useStateStore} from '@/stores/state'\r\nimport {userLoginService, userRegisterService,userCheckRoleService} from \"@/api/user\";\r\nimport {ElMessage} from \"element-plus\";\r\nimport router from \"@/router\";\r\n\r\n\r\nconst tokenStore = useTokenStore();\r\nconst stateStore = useStateStore();\r\n\r\nconst register = async () => {\r\n  try {\r\n    let result = await userRegisterService(form_register.value);\r\n    ElMessage.success('注册成功')\r\n\r\n    router.push('/login')\r\n  } catch (err) {\r\n    console.log(err)\r\n  }\r\n\r\n}\r\nconst login = async () => {\r\n  try {\r\n    let result = await userLoginService(form_login.value);\r\n    ElMessage.success('登录成功')\r\n    //将得到的token存储到pinia中\r\n    tokenStore.setToken(result.data);\r\n\r\n    await loginSta()\r\n\r\n    router.push('/')\r\n  } catch (err) {\r\n    console.log(err)\r\n  }\r\n\r\n\r\n}\r\n\r\nconst loginSta = async () => {\r\n  try {\r\n    let res = await userCheckRoleService()\r\n    if (res.data !== 3) {\r\n      stateStore.setState(res.data)\r\n      router.push('/')\r\n    }else {\r\n      stateStore.setState(res.data)\r\n    }\r\n\r\n  }catch(err) {\r\n    if(err?.response?.status === 401){\r\n\r\n    }\r\n  }\r\n}\r\n\r\nonMounted(()=>{\r\n  loginSta()\r\n})\r\n\r\n</script>\r\n\r\n<template>\r\n  <el-row :gutter=\"0\">\r\n    <!--表单部分-->\r\n    <el-col :span=\"8\" class=\"form-box\">\r\n      <div>\r\n        <LoginSwitch @modeChange=\"handleLoginMode\" style=\"margin-bottom: 20px; margin-top: 40px; left: 32%\"/>\r\n\r\n        <!--登录-->\r\n        <transition name=\"form-fade\" mode=\"out-in\">\r\n          <div :key=\"loginMode\">\r\n            <el-form :model=\"form_login\" label-width=\"auto\" class=\"login-form\" v-if=\"loginMode\" :rules=\"rules_login\">\r\n              <el-form-item label=\"用户名 :\" style=\"margin: 20px;\" prop=\"username\">\r\n                <el-input v-model=\"form_login.username\" style=\"width: 235px; height: 35px\"/>\r\n              </el-form-item>\r\n              <el-form-item label=\"密码 :\" style=\"margin: 20px; margin-top: 30px; margin-bottom: 30px\"\r\n                            prop=\"password\">\r\n                <el-input v-model=\"form_login.password\" style=\"width: 235px; height: 35px\"/>\r\n              </el-form-item>\r\n\r\n              <div style=\"text-align: center; margin-top: 20px;\">\r\n                <el-button type=\"primary\" @click=\"login\"\r\n                           style=\"width: 160px; height: 50px; font-size: 26px; font-family: 'Poor Richard';\">\r\n                  GoFindBeauty\r\n                </el-button>\r\n              </div>\r\n            </el-form>\r\n\r\n            <!--注册-->\r\n            <el-form :model=\"form_register\" label-width=\"auto\" class=\"login-form\" v-else\r\n                     :rules=\"rules_register\">\r\n              <el-form-item label=\"用户名 :\" style=\"margin: 20px;\" prop=\"username\">\r\n                <el-input v-model=\"form_register.username\" style=\"width: 235px; height: 35px\"/>\r\n              </el-form-item>\r\n              <el-form-item label=\"昵称 :\" style=\"margin: 20px; margin-top: 30px; margin-bottom: 30px\"\r\n                            prop=\"nickname\">\r\n                <el-input v-model=\"form_register.nickname\" style=\"width: 235px; height: 35px\"/>\r\n              </el-form-item>\r\n              <el-form-item label=\"性别 :\" style=\"margin-left: 20px;\" prop=\"gender\">\r\n                <el-radio-group v-model=\"form_register.gender\" class=\"gender-radio-group\">\r\n                  <el-radio value=\"男\" style=\"margin-left: 20px; margin-right: 40px;\">男</el-radio>\r\n                  <el-radio value=\"女\">女</el-radio>\r\n                </el-radio-group>\r\n              </el-form-item>\r\n              <el-form-item label=\"密码 :\" style=\"margin: 20px; margin-top: 30px; margin-bottom: 30px\"\r\n                            prop=\"password\">\r\n                <el-input v-model=\"form_register.password\" style=\"width: 235px; height: 35px\"/>\r\n              </el-form-item>\r\n              <el-form-item label=\"确认密码 :\" style=\"margin: 20px; margin-top: 30px; margin-bottom: 30px\"\r\n                            prop=\"repassword\">\r\n                <el-input v-model=\"form_register.repassword\" style=\"width: 235px; height: 35px\"/>\r\n              </el-form-item>\r\n              <el-form-item label=\"邮箱 :\" style=\"margin: 20px; margin-top: 30px; margin-bottom: 30px\" prop=\"email\">\r\n                <el-input v-model=\"form_register.email\" style=\"width: 235px; height: 35px\"/>\r\n              </el-form-item>\r\n\r\n\r\n              <div style=\"text-align: center; margin-top: 20px;\">\r\n                <el-button type=\"primary\" @click=\"register\"\r\n                           style=\"width: 240px; height: 50px; font-size: 26px; font-family: 'Poor Richard';\">\r\n                  StratJourneyToBeauty\r\n                </el-button>\r\n              </div>\r\n            </el-form>\r\n          </div>\r\n        </transition>\r\n      </div>\r\n    </el-col>\r\n\r\n\r\n    <!--图像部分-->\r\n    <el-col :span=\"16\" class=\"pic\">\r\n\r\n    </el-col>\r\n  </el-row>\r\n</template>\r\n\r\n<style scoped>\r\n* {\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n\r\nhtml, body {\r\n  height: 100%;\r\n}\r\n\r\n.el-row {\r\n  flex: 1;\r\n  display: flex;\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\n\r\n.form-box {\r\n  display: flex;\r\n  justify-content: center;\r\n  padding-top: 80px;\r\n  height: 100%;\r\n  padding: 20px;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.login-form {\r\n  background: white;\r\n  width: 400px;\r\n  padding: 30px 40px;\r\n  border-radius: 10px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n\r\n}\r\n\r\n.form-fade-enter-active,\r\n.form-fade-leave-active {\r\n  transition: all 0.6s ease;\r\n}\r\n\r\n.form-fade-enter-from,\r\n.form-fade-leave-to {\r\n  opacity: 0;\r\n  transform: scale(0.9);\r\n}\r\n\r\n.form-fade-enter-to,\r\n.form-fade-leave-from {\r\n  opacity: 1;\r\n  transform: scale(1);\r\n}\r\n\r\n::v-deep(.el-form-item__label) {\r\n  font-family: 'Poor Richard', serif;\r\n  font-size: 26px;\r\n}\r\n\r\n::v-deep(.el-input__inner) {\r\n  font-family: 'Poor Richard', serif;\r\n  font-size: 20px;\r\n}\r\n\r\n::v-deep(.gender-radio-group .el-radio) {\r\n  margin-right: 30px;\r\n  font-size: 20px;\r\n  transform: scale(1.3);\r\n}\r\n\r\n.pic {\r\n  background: #9a578d;\r\n  height: 100%;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}