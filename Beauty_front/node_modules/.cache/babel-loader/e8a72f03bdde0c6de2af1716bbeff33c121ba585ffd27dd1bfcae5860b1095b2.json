{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport { ElMessage } from 'element-plus';\nimport { QuillEditor } from '@vueup/vue-quill';\nimport '@vueup/vue-quill/dist/vue-quill.snow.css';\nimport { hairstyleList, hairstyleInfo, hairstyleAdd, hairstyleDel, hairstyleUpdate } from '@/api/hairstyle';\nimport { uploadFile } from '@/api/fileUpload';\nexport default {\n  __name: 'HairstyleManage',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const tableData = ref([]);\n    const pageNum = ref(1);\n    const pageSize = ref(6);\n    const total = ref(0);\n    const keyWord = ref('');\n    const editDialogVisible = ref(false);\n    const createDialogVisible = ref(false);\n    const editForm = ref({});\n    const createForm = ref({\n      hairstyle_name: '',\n      hairstyle_pic: '',\n      content: ''\n    });\n    const quillRefEdit = ref(null);\n    const quillRefCreate = ref(null);\n\n    // Quill 配置\n    const getQuillModules = quillRef => ({\n      toolbar: {\n        container: [['bold', 'italic', 'underline'], [{\n          list: 'ordered'\n        }, {\n          list: 'bullet'\n        }], ['link', 'image']],\n        handlers: {\n          image() {\n            const input = document.createElement('input');\n            input.setAttribute('type', 'file');\n            input.setAttribute('accept', 'image/*');\n            input.click();\n            input.onchange = async () => {\n              const file = input.files[0];\n              if (!file || !quillRef.value) return;\n              try {\n                const res = await uploadFile(file);\n                const imageUrl = res.data;\n                const quill = quillRef.value.getEditor();\n                const range = quill.getSelection();\n                quill.insertEmbed(range.index, 'image', imageUrl);\n                quill.setSelection(range.index + 1);\n              } catch (err) {\n                ElMessage.error('图片上传失败');\n              }\n            };\n          }\n        }\n      }\n    });\n\n    // 获取数据\n    const fetchData = async () => {\n      const res = await hairstyleList({\n        pageNum: pageNum.value,\n        pageSize: pageSize.value,\n        keyWord: keyWord.value\n      });\n      tableData.value = res.data.items;\n      total.value = res.data.total;\n    };\n    const handleSaveEdit = async () => {\n      await hairstyleUpdate(editForm.value);\n      ElMessage.success('保存成功');\n      editDialogVisible.value = false;\n      fetchData();\n    };\n    const handleCreateSubmit = async () => {\n      await hairstyleAdd(createForm.value);\n      ElMessage.success('创建成功');\n      createDialogVisible.value = false;\n      fetchData();\n    };\n    onMounted(fetchData);\n    const __returned__ = {\n      tableData,\n      pageNum,\n      pageSize,\n      total,\n      keyWord,\n      editDialogVisible,\n      createDialogVisible,\n      editForm,\n      createForm,\n      quillRefEdit,\n      quillRefCreate,\n      getQuillModules,\n      fetchData,\n      handleSaveEdit,\n      handleCreateSubmit,\n      ref,\n      onMounted,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get QuillEditor() {\n        return QuillEditor;\n      },\n      get hairstyleList() {\n        return hairstyleList;\n      },\n      get hairstyleInfo() {\n        return hairstyleInfo;\n      },\n      get hairstyleAdd() {\n        return hairstyleAdd;\n      },\n      get hairstyleDel() {\n        return hairstyleDel;\n      },\n      get hairstyleUpdate() {\n        return hairstyleUpdate;\n      },\n      get uploadFile() {\n        return uploadFile;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","ElMessage","QuillEditor","hairstyleList","hairstyleInfo","hairstyleAdd","hairstyleDel","hairstyleUpdate","uploadFile","tableData","pageNum","pageSize","total","keyWord","editDialogVisible","createDialogVisible","editForm","createForm","hairstyle_name","hairstyle_pic","content","quillRefEdit","quillRefCreate","getQuillModules","quillRef","toolbar","container","list","handlers","image","input","document","createElement","setAttribute","click","onchange","file","files","value","res","imageUrl","data","quill","getEditor","range","getSelection","insertEmbed","index","setSelection","err","error","fetchData","items","handleSaveEdit","success","handleCreateSubmit"],"sources":["C:/Users/32561/Desktop/毕设仓库/beauty-front/src/views/manage/hairstyle/HairstyleManage.vue"],"sourcesContent":["<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport { QuillEditor } from '@vueup/vue-quill'\r\nimport '@vueup/vue-quill/dist/vue-quill.snow.css'\r\n\r\nimport {\r\n  hairstyleList, hairstyleInfo,\r\n  hairstyleAdd, hairstyleDel,\r\n  hairstyleUpdate\r\n} from '@/api/hairstyle'\r\n\r\nimport { uploadFile } from '@/api/fileUpload'\r\n\r\nconst tableData = ref([])\r\nconst pageNum = ref(1)\r\nconst pageSize = ref(6)\r\nconst total = ref(0)\r\nconst keyWord = ref('')\r\nconst editDialogVisible = ref(false)\r\nconst createDialogVisible = ref(false)\r\nconst editForm = ref({})\r\nconst createForm = ref({\r\n  hairstyle_name: '',\r\n  hairstyle_pic: '',\r\n  content: ''\r\n})\r\nconst quillRefEdit = ref(null)\r\nconst quillRefCreate = ref(null)\r\n\r\n// Quill 配置\r\nconst getQuillModules = (quillRef) => ({\r\n  toolbar: {\r\n    container: [\r\n      ['bold', 'italic', 'underline'],\r\n      [{list: 'ordered'}, {list: 'bullet'}],\r\n      ['link', 'image']\r\n    ],\r\n    handlers: {\r\n      image() {\r\n        const input = document.createElement('input')\r\n        input.setAttribute('type', 'file')\r\n        input.setAttribute('accept', 'image/*')\r\n        input.click()\r\n\r\n        input.onchange = async () => {\r\n          const file = input.files[0]\r\n          if (!file || !quillRef.value) return\r\n\r\n          try {\r\n            const res = await uploadFile(file)\r\n            const imageUrl = res.data\r\n            const quill = quillRef.value.getEditor()\r\n            const range = quill.getSelection()\r\n            quill.insertEmbed(range.index, 'image', imageUrl)\r\n            quill.setSelection(range.index + 1)\r\n          } catch (err) {\r\n            ElMessage.error('图片上传失败')\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\n// 获取数据\r\nconst fetchData = async () => {\r\n  const res = await hairstyleList({pageNum: pageNum.value, pageSize: pageSize.value, keyWord: keyWord.value})\r\n  tableData.value = res.data.items\r\n  total.value = res.data.total\r\n}\r\n\r\nconst handleSaveEdit = async () => {\r\n  await hairstyleUpdate(editForm.value)\r\n  ElMessage.success('保存成功')\r\n  editDialogVisible.value = false\r\n  fetchData()\r\n}\r\n\r\nconst handleCreateSubmit = async () => {\r\n  await hairstyleAdd(createForm.value)\r\n  ElMessage.success('创建成功')\r\n  createDialogVisible.value = false\r\n  fetchData()\r\n}\r\n\r\nonMounted(fetchData)\r\n</script>\r\n\r\n<template>\r\n  <el-button type=\"primary\" @click=\"createDialogVisible = true\">新建发型</el-button>\r\n\r\n  <!-- 编辑对话框 -->\r\n  <el-dialog v-model=\"editDialogVisible\" title=\"编辑发型\" width=\"600px\">\r\n    <el-form :model=\"editForm\" label-width=\"80px\">\r\n      <el-form-item label=\"名称\">\r\n        <el-input v-model=\"editForm.hairstyle_name\"/>\r\n      </el-form-item>\r\n      <el-form-item label=\"内容\" class=\"full-width-editor\">\r\n        <QuillEditor\r\n            v-model:content=\"editForm.content\"\r\n            contentType=\"html\"\r\n            :modules=\"getQuillModules(quillRefEdit)\"\r\n            ref=\"quillRefEdit\"\r\n            style=\"height: 200px;\"\r\n        />\r\n      </el-form-item>\r\n    </el-form>\r\n    <template #footer>\r\n      <el-button @click=\"editDialogVisible = false\">取消</el-button>\r\n      <el-button type=\"primary\" @click=\"handleSaveEdit\">保存</el-button>\r\n    </template>\r\n  </el-dialog>\r\n\r\n  <!-- 新建对话框 -->\r\n  <el-dialog v-model=\"createDialogVisible\" title=\"新建发型\" width=\"600px\">\r\n    <el-form :model=\"createForm\" label-width=\"80px\">\r\n      <el-form-item label=\"名称\">\r\n        <el-input v-model=\"createForm.hairstyle_name\"/>\r\n      </el-form-item>\r\n      <el-form-item label=\"内容\" class=\"full-width-editor\">\r\n        <QuillEditor\r\n            v-model:content=\"createForm.content\"\r\n            contentType=\"html\"\r\n            :modules=\"getQuillModules(quillRefCreate)\"\r\n            ref=\"quillRefCreate\"\r\n            style=\"height: 200px;\"\r\n        />\r\n      </el-form-item>\r\n    </el-form>\r\n    <template #footer>\r\n      <el-button @click=\"createDialogVisible = false\">取消</el-button>\r\n      <el-button type=\"primary\" @click=\"handleCreateSubmit\">创建</el-button>\r\n    </template>\r\n  </el-dialog>\r\n</template>\r\n\r\n<style scoped>\r\n.full-width-editor .el-form-item__content {\r\n  margin-left: 0 !important;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}