{"ast":null,"code":"import { openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  class: \"editor-wrapper\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return $props.visible ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [$props.visible && $props.ready && $setup.editorRef ? (_openBlock(), _createBlock($setup[\"Toolbar\"], {\n    key: 0,\n    editor: $setup.editorRef,\n    mode: \"default\"\n  }, null, 8 /* PROPS */, [\"editor\"])) : _createCommentVNode(\"v-if\", true), $props.visible && $props.ready ? (_openBlock(), _createBlock($setup[\"Editor\"], {\n    key: 1,\n    modelValue: $setup.localValue,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.localValue = $event),\n    defaultConfig: $setup.editorConfig,\n    mode: \"default\",\n    style: {\n      \"height\": \"300px\",\n      \"width\": \"100%\",\n      \"overflow-y\": \"auto\"\n    },\n    onOnCreated: _cache[1] || (_cache[1] = editor => $setup.editorRef = editor)\n  }, null, 8 /* PROPS */, [\"modelValue\"])) : _createCommentVNode(\"v-if\", true)])) : _createCommentVNode(\"v-if\", true);\n}","map":{"version":3,"names":["key","class","$props","visible","_createElementBlock","_hoisted_1","ready","$setup","editorRef","_createBlock","editor","mode","_createCommentVNode","modelValue","localValue","_cache","$event","defaultConfig","editorConfig","style","onOnCreated"],"sources":["C:\\Users\\32561\\Desktop\\毕设仓库\\beauty-front\\src\\components\\RichTextEditor.vue"],"sourcesContent":["<template>\r\n  <div class=\"editor-wrapper\" v-if=\"visible\">\r\n    <Toolbar v-if=\"visible && ready && editorRef\" :editor=\"editorRef\" mode=\"default\" />\r\n    <Editor\r\n        v-if=\"visible && ready\"\r\n        v-model=\"localValue\"\r\n        :defaultConfig=\"editorConfig\"\r\n        mode=\"default\"\r\n        style=\"height: 300px; width: 100%; overflow-y: auto\"\r\n        @onCreated=\"editor => (editorRef = editor)\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, watch, onBeforeUnmount } from 'vue'\r\nimport { Editor, Toolbar } from '@wangeditor/editor-for-vue'\r\nimport '@wangeditor/editor/dist/css/style.css'\r\nimport { uploadFile } from '@/api/fileUpload'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nconst props = defineProps({\r\n  modelValue: String,\r\n  visible: Boolean,\r\n  ready: Boolean\r\n})\r\n\r\nconst emit = defineEmits(['update:modelValue'])\r\n\r\nlet editorRef = null             // ✅ 非响应式，避免 Proxy 报错\r\nconst editorReady = ref(false)   // ✅ 控制编辑器挂载时机\r\nconst localValue = ref(props.modelValue)\r\n\r\n// 父 -> 子\r\nwatch(() => props.modelValue, (val) => {\r\n  localValue.value = val\r\n})\r\n\r\n// 子 -> 父\r\nwatch(localValue, (val) => {\r\n  emit('update:modelValue', val)\r\n})\r\n\r\nconst editorConfig = {\r\n  placeholder: '请输入内容...',\r\n  MENU_CONF: {\r\n    uploadImage: {\r\n      async customUpload(file, insertFn) {\r\n        try {\r\n          const res = await uploadFile(file)\r\n          insertFn(String(res.data), '', '')\r\n          ElMessage.success('图片上传成功')\r\n        } catch {\r\n          ElMessage.error('图片上传失败')\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 监听 visible 控制挂载 & 销毁\r\nwatch(() => props.visible, (val) => {\r\n  if (val) {\r\n    setTimeout(() => {\r\n      editorReady.value = true\r\n    }, 50) // 延迟 50ms，确保样式加载完成再挂载\r\n  } else {\r\n    editorReady.value = false\r\n    if (editorRef) {\r\n      editorRef.destroy()\r\n      editorRef = null\r\n    }\r\n  }\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  if (editorRef) {\r\n    editorRef.destroy()\r\n    editorRef = null\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.editor-wrapper {\r\n  border: 1px solid #dcdfe6;\r\n  border-radius: 4px;\r\n  overflow: hidden;\r\n  margin-top: 10px;\r\n}\r\n\r\n.w-e-text-container {\r\n  min-height: 200px;\r\n  padding: 10px;\r\n}\r\n\r\n.w-e-text img {\r\n  max-width: 100%;\r\n  height: auto;\r\n  display: block;\r\n  margin: 10px 0;\r\n  cursor: nwse-resize;\r\n}\r\n</style>\r\n"],"mappings":";;EAAAA,GAAA;EACOC,KAAK,EAAC;;;SAAuBC,MAAA,CAAAC,OAAO,I,cAAzCC,mBAAA,CAUM,OAVNC,UAUM,GATWH,MAAA,CAAAC,OAAO,IAAID,MAAA,CAAAI,KAAK,IAAIC,MAAA,CAAAC,SAAS,I,cAA5CC,YAAA,CAAmFF,MAAA;IAFvFP,GAAA;IAEmDU,MAAM,EAAEH,MAAA,CAAAC,SAAS;IAAEG,IAAI,EAAC;yCAF3EC,mBAAA,gBAIcV,MAAA,CAAAC,OAAO,IAAID,MAAA,CAAAI,KAAK,I,cAD1BG,YAAA,CAOEF,MAAA;IAVNP,GAAA;IAAAa,UAAA,EAKiBN,MAAA,CAAAO,UAAU;IAL3B,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAKiBT,MAAA,CAAAO,UAAU,GAAAE,MAAA;IAClBC,aAAa,EAAEV,MAAA,CAAAW,YAAY;IAC5BP,IAAI,EAAC,SAAS;IACdQ,KAAoD,EAApD;MAAA;MAAA;MAAA;IAAA,CAAoD;IACnDC,WAAS,EAAAL,MAAA,QAAAA,MAAA,MAAEL,MAAM,IAAKH,MAAA,CAAAC,SAAS,GAAGE,MAAM;6CATjDE,mBAAA,e,KAAAA,mBAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}