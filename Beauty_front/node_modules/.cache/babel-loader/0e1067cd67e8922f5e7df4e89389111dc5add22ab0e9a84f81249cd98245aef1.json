{"ast":null,"code":"import { ref, onMounted } from \"vue\";\nimport { ElMessage, ElMessageBox } from \"element-plus\";\nimport { offlineRequestListExa, offlineExamine } from \"@/api/your-api-path\"; // 替换为你的实际路径\n\nexport default {\n  __name: 'RequestManage',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const tableData = ref([]);\n    const pageNum = ref(1);\n    const pageSize = ref(10);\n    const total = ref(0);\n\n    // 加载申请列表\n    const fetchData = async () => {\n      try {\n        const res = await offlineRequestListExa({\n          pageNum: pageNum.value,\n          pageSize: pageSize.value\n        });\n        tableData.value = res.data.items || [];\n        total.value = res.data.total || 0;\n      } catch (err) {\n        ElMessage.error(err.msg || \"获取审核列表失败\");\n      }\n    };\n\n    // 分页变化\n    const handlePageChange = newPage => {\n      pageNum.value = newPage;\n      fetchData();\n    };\n\n    // 通过审核\n    const handleApprove = async requestId => {\n      try {\n        await offlineExamine(requestId, 0, '');\n        ElMessage.success(\"已通过申请\");\n        fetchData();\n      } catch (err) {\n        ElMessage.error(err.msg || \"操作失败\");\n      }\n    };\n\n    // 否决审核\n    const handleReject = async requestId => {\n      try {\n        const reason = await ElMessageBox.prompt(\"请输入否决原因：\", \"否决申请\", {\n          confirmButtonText: \"确认\",\n          cancelButtonText: \"取消\",\n          inputPattern: /.+/,\n          inputErrorMessage: \"原因不能为空\"\n        });\n        await offlineExamine(requestId, 1, reason.value);\n        ElMessage.success(\"已否决申请\");\n        fetchData();\n      } catch (err) {\n        if (err !== 'cancel') {\n          ElMessage.error(err.msg || \"操作失败\");\n        }\n      }\n    };\n    onMounted(() => {\n      fetchData();\n    });\n    const __returned__ = {\n      tableData,\n      pageNum,\n      pageSize,\n      total,\n      fetchData,\n      handlePageChange,\n      handleApprove,\n      handleReject,\n      ref,\n      onMounted,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get ElMessageBox() {\n        return ElMessageBox;\n      },\n      get offlineRequestListExa() {\n        return offlineRequestListExa;\n      },\n      get offlineExamine() {\n        return offlineExamine;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","ElMessage","ElMessageBox","offlineRequestListExa","offlineExamine","tableData","pageNum","pageSize","total","fetchData","res","value","data","items","err","error","msg","handlePageChange","newPage","handleApprove","requestId","success","handleReject","reason","prompt","confirmButtonText","cancelButtonText","inputPattern","inputErrorMessage"],"sources":["C:/Users/32561/Desktop/毕设仓库/beauty-front/src/views/manage/offline/RequestManage.vue"],"sourcesContent":["<script setup>\r\nimport {ref, onMounted} from \"vue\"\r\nimport {ElMessage, ElMessageBox} from \"element-plus\"\r\nimport {offlineRequestListExa, offlineExamine} from \"@/api/your-api-path\" // 替换为你的实际路径\r\n\r\nconst tableData = ref([])\r\nconst pageNum = ref(1)\r\nconst pageSize = ref(10)\r\nconst total = ref(0)\r\n\r\n// 加载申请列表\r\nconst fetchData = async () => {\r\n  try {\r\n    const res = await offlineRequestListExa({\r\n      pageNum: pageNum.value,\r\n      pageSize: pageSize.value\r\n    })\r\n    tableData.value = res.data.items || []\r\n    total.value = res.data.total || 0\r\n  } catch (err) {\r\n    ElMessage.error(err.msg || \"获取审核列表失败\")\r\n  }\r\n}\r\n\r\n// 分页变化\r\nconst handlePageChange = (newPage) => {\r\n  pageNum.value = newPage\r\n  fetchData()\r\n}\r\n\r\n// 通过审核\r\nconst handleApprove = async (requestId) => {\r\n  try {\r\n    await offlineExamine(requestId, 0, '')\r\n    ElMessage.success(\"已通过申请\")\r\n    fetchData()\r\n  } catch (err) {\r\n    ElMessage.error(err.msg || \"操作失败\")\r\n  }\r\n}\r\n\r\n// 否决审核\r\nconst handleReject = async (requestId) => {\r\n  try {\r\n    const reason = await ElMessageBox.prompt(\r\n        \"请输入否决原因：\",\r\n        \"否决申请\",\r\n        {\r\n          confirmButtonText: \"确认\",\r\n          cancelButtonText: \"取消\",\r\n          inputPattern: /.+/,\r\n          inputErrorMessage: \"原因不能为空\"\r\n        }\r\n    )\r\n    await offlineExamine(requestId, 1, reason.value)\r\n    ElMessage.success(\"已否决申请\")\r\n    fetchData()\r\n  } catch (err) {\r\n    if (err !== 'cancel') {\r\n      ElMessage.error(err.msg || \"操作失败\")\r\n    }\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  fetchData()\r\n})\r\n</script>\r\n\r\n<template>\r\n  <el-row :gutter=\"0\">\r\n    <div class=\"path\">\r\n      <p style=\"font-size: 20px; margin-top: 5px\">门店审核</p>\r\n    </div>\r\n\r\n    <div class=\"search\">\r\n\r\n    </div>\r\n\r\n    <el-table :data=\"tableData\" style=\"width: 100%; margin-top: 10px\">\r\n      <el-table-column prop=\"request_id\" label=\"申请ID\" width=\"120\"/>\r\n      <el-table-column prop=\"manager_id\" label=\"店长ID\" width=\"120\"/>\r\n      <el-table-column prop=\"nickname\" label=\"店长昵称\" width=\"160\"/>\r\n      <el-table-column prop=\"email\" label=\"店长邮箱\" width=\"240\"/>\r\n      <el-table-column prop=\"target_city\" label=\"目标城市\" width=\"160\"/>\r\n      <el-table-column label=\"否决原因\" width=\"240\">\r\n        <template #default=\"{ row }\">\r\n          {{ row.review_comments || '-' }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" width=\"240\">\r\n        <template #default=\"{ row }\">\r\n          <el-button type=\"success\" size=\"small\" @click=\"handleApprove(row.request_id)\">通过</el-button>\r\n          <el-button type=\"danger\" size=\"small\" @click=\"handleReject(row.request_id)\">否决</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <div style=\"text-align: center; margin-top: 20px\">\r\n      <el-pagination\r\n          background\r\n          layout=\"prev, pager, next, ->, total\"\r\n          :total=\"total\"\r\n          :current-page=\"pageNum\"\r\n          :page-size=\"pageSize\"\r\n          @current-change=\"handlePageChange\"\r\n      />\r\n    </div>\r\n  </el-row>\r\n</template>\r\n\r\n<style scoped>\r\n.path {\r\n  height: 40px;\r\n  width: 100%;\r\n  background-color: #d8a6a6;\r\n}\r\n\r\n::v-deep(.el-table__row) {\r\n  height: 60px;\r\n}\r\n\r\n.search {\r\n  width: 100%;\r\n  height: 52px;\r\n  background-color: #bbd2e3;\r\n}\r\n</style>\r\n"],"mappings":"AACA,SAAQA,GAAG,EAAEC,SAAS,QAAO,KAAK;AAClC,SAAQC,SAAS,EAAEC,YAAY,QAAO,cAAc;AACpD,SAAQC,qBAAqB,EAAEC,cAAc,QAAO,qBAAqB,EAAC;;;;;;;;IAE1E,MAAMC,SAAS,GAAGN,GAAG,CAAC,EAAE,CAAC;IACzB,MAAMO,OAAO,GAAGP,GAAG,CAAC,CAAC,CAAC;IACtB,MAAMQ,QAAQ,GAAGR,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMS,KAAK,GAAGT,GAAG,CAAC,CAAC,CAAC;;IAEpB;IACA,MAAMU,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC5B,IAAI;QACF,MAAMC,GAAG,GAAG,MAAMP,qBAAqB,CAAC;UACtCG,OAAO,EAAEA,OAAO,CAACK,KAAK;UACtBJ,QAAQ,EAAEA,QAAQ,CAACI;QACrB,CAAC,CAAC;QACFN,SAAS,CAACM,KAAK,GAAGD,GAAG,CAACE,IAAI,CAACC,KAAK,IAAI,EAAE;QACtCL,KAAK,CAACG,KAAK,GAAGD,GAAG,CAACE,IAAI,CAACJ,KAAK,IAAI,CAAC;MACnC,CAAC,CAAC,OAAOM,GAAG,EAAE;QACZb,SAAS,CAACc,KAAK,CAACD,GAAG,CAACE,GAAG,IAAI,UAAU,CAAC;MACxC;IACF,CAAC;;IAED;IACA,MAAMC,gBAAgB,GAAIC,OAAO,IAAK;MACpCZ,OAAO,CAACK,KAAK,GAAGO,OAAO;MACvBT,SAAS,CAAC,CAAC;IACb,CAAC;;IAED;IACA,MAAMU,aAAa,GAAG,MAAOC,SAAS,IAAK;MACzC,IAAI;QACF,MAAMhB,cAAc,CAACgB,SAAS,EAAE,CAAC,EAAE,EAAE,CAAC;QACtCnB,SAAS,CAACoB,OAAO,CAAC,OAAO,CAAC;QAC1BZ,SAAS,CAAC,CAAC;MACb,CAAC,CAAC,OAAOK,GAAG,EAAE;QACZb,SAAS,CAACc,KAAK,CAACD,GAAG,CAACE,GAAG,IAAI,MAAM,CAAC;MACpC;IACF,CAAC;;IAED;IACA,MAAMM,YAAY,GAAG,MAAOF,SAAS,IAAK;MACxC,IAAI;QACF,MAAMG,MAAM,GAAG,MAAMrB,YAAY,CAACsB,MAAM,CACpC,UAAU,EACV,MAAM,EACN;UACEC,iBAAiB,EAAE,IAAI;UACvBC,gBAAgB,EAAE,IAAI;UACtBC,YAAY,EAAE,IAAI;UAClBC,iBAAiB,EAAE;QACrB,CACJ,CAAC;QACD,MAAMxB,cAAc,CAACgB,SAAS,EAAE,CAAC,EAAEG,MAAM,CAACZ,KAAK,CAAC;QAChDV,SAAS,CAACoB,OAAO,CAAC,OAAO,CAAC;QAC1BZ,SAAS,CAAC,CAAC;MACb,CAAC,CAAC,OAAOK,GAAG,EAAE;QACZ,IAAIA,GAAG,KAAK,QAAQ,EAAE;UACpBb,SAAS,CAACc,KAAK,CAACD,GAAG,CAACE,GAAG,IAAI,MAAM,CAAC;QACpC;MACF;IACF,CAAC;IAEDhB,SAAS,CAAC,MAAM;MACdS,SAAS,CAAC,CAAC;IACb,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}