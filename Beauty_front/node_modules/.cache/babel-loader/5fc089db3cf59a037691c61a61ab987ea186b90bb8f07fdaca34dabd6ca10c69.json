{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { memberList, addMember, delMember } from '@/api/offline';\n\n// 获取 offline_id 参数\n\nexport default {\n  __name: 'myMember',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const route = useRoute();\n    const offlineId = route.params.id;\n    const members = ref([]);\n    const loading = ref(false);\n    const router = useRouter();\n    const form = ref({\n      offline_id: offlineId,\n      username: '',\n      member_name: ''\n    });\n    const fetchMembers = async () => {\n      loading.value = true;\n      try {\n        const res = await memberList(offlineId);\n        members.value = res.data || [];\n      } catch (err) {\n        ElMessage.error(err.msg || '获取成员列表失败');\n      } finally {\n        loading.value = false;\n      }\n    };\n    const handleAddMember = async () => {\n      if (!form.value.username || !form.value.member_name) {\n        ElMessage.warning('请填写完整信息');\n        return;\n      }\n      try {\n        await addMember({\n          offline_id: offlineId,\n          username: form.value.username,\n          member_name: form.value.member_name\n        });\n        ElMessage.success('成员添加成功');\n        form.value.username = '';\n        form.value.member_name = '';\n        fetchMembers();\n      } catch (err) {\n        ElMessage.error(err.msg || '添加成员失败');\n      }\n    };\n    const handleDelete = member_id => {\n      ElMessageBox.confirm('确认删除该成员吗？', '提示', {\n        confirmButtonText: '删除',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(async () => {\n        try {\n          await delMember(member_id);\n          ElMessage.success('删除成功');\n          fetchMembers();\n        } catch (err) {\n          ElMessage.error(err.msg || '删除失败');\n        }\n      }).catch(() => {});\n    };\n    onMounted(() => {\n      fetchMembers();\n    });\n    const __returned__ = {\n      route,\n      offlineId,\n      members,\n      loading,\n      router,\n      form,\n      fetchMembers,\n      handleAddMember,\n      handleDelete,\n      ref,\n      onMounted,\n      get useRoute() {\n        return useRoute;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      get ElMessageBox() {\n        return ElMessageBox;\n      },\n      get memberList() {\n        return memberList;\n      },\n      get addMember() {\n        return addMember;\n      },\n      get delMember() {\n        return delMember;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","useRoute","useRouter","ElMessage","ElMessageBox","memberList","addMember","delMember","route","offlineId","params","id","members","loading","router","form","offline_id","username","member_name","fetchMembers","value","res","data","err","error","msg","handleAddMember","warning","success","handleDelete","member_id","confirm","confirmButtonText","cancelButtonText","type","then","catch"],"sources":["C:/Users/32561/Desktop/毕设仓库/beauty-front/src/views/Mine/myMember.vue"],"sourcesContent":["<script setup>\r\nimport {ref, onMounted} from 'vue'\r\nimport {useRoute,useRouter} from 'vue-router'\r\nimport {ElMessage, ElMessageBox} from 'element-plus'\r\nimport {memberList, addMember, delMember} from '@/api/offline'\r\n\r\n// 获取 offline_id 参数\r\nconst route = useRoute()\r\nconst offlineId = route.params.id\r\n\r\nconst members = ref([])\r\nconst loading = ref(false)\r\n\r\nconst router = useRouter()\r\n\r\n\r\nconst form = ref({\r\n  offline_id: offlineId,\r\n  username: '',\r\n  member_name: ''\r\n})\r\n\r\nconst fetchMembers = async () => {\r\n  loading.value = true\r\n  try {\r\n    const res = await memberList(offlineId)\r\n    members.value = res.data || []\r\n  } catch (err) {\r\n    ElMessage.error(err.msg || '获取成员列表失败')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst handleAddMember = async () => {\r\n  if (!form.value.username || !form.value.member_name) {\r\n    ElMessage.warning('请填写完整信息')\r\n    return\r\n  }\r\n\r\n  try {\r\n    await addMember({\r\n      offline_id: offlineId,\r\n      username: form.value.username,\r\n      member_name: form.value.member_name\r\n    })\r\n    ElMessage.success('成员添加成功')\r\n    form.value.username = ''\r\n    form.value.member_name = ''\r\n    fetchMembers()\r\n  } catch (err) {\r\n    ElMessage.error(err.msg || '添加成员失败')\r\n  }\r\n}\r\n\r\nconst handleDelete = (member_id) => {\r\n  ElMessageBox.confirm(\r\n      '确认删除该成员吗？',\r\n      '提示',\r\n      {\r\n        confirmButtonText: '删除',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }\r\n  ).then(async () => {\r\n    try {\r\n      await delMember(member_id)\r\n      ElMessage.success('删除成功')\r\n      fetchMembers()\r\n    } catch (err) {\r\n      ElMessage.error(err.msg || '删除失败')\r\n    }\r\n  }).catch(() => {\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  fetchMembers()\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"main-content\">\r\n    <!-- 返回按钮 -->\r\n    <el-button\r\n        type=\"primary\"\r\n        icon=\"el-icon-arrow-left\"\r\n        plain\r\n        @click=\"router.back()\"\r\n        style=\"margin-bottom: 20px\"\r\n    >\r\n      返回\r\n    </el-button>\r\n    <div class=\"member-page\">\r\n      <div class=\"left-table\">\r\n        <el-table :data=\"members\" v-loading=\"loading\" stripe border style=\"width: 100%\">\r\n          <el-table-column prop=\"member_id\" label=\"成员ID\" width=\"100\"/>\r\n          <el-table-column prop=\"username\" label=\"用户名\"/>\r\n          <el-table-column prop=\"nickname\" label=\"昵称\"/>\r\n          <el-table-column prop=\"member_name\" label=\"成员名\"/>\r\n          <el-table-column label=\"操作\" width=\"120\">\r\n            <template #default=\"{ row }\">\r\n              <el-button type=\"danger\" size=\"small\" @click=\"handleDelete(row.member_id)\">删除</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n\r\n      <div class=\"right-form\">\r\n        <h3>添加新成员</h3>\r\n        <el-input\r\n            v-model=\"form.username\"\r\n            placeholder=\"请输入用户名\"\r\n            style=\"margin-bottom: 12px\"\r\n        />\r\n        <el-input\r\n            v-model=\"form.member_name\"\r\n            placeholder=\"请输入成员名\"\r\n            style=\"margin-bottom: 12px\"\r\n        />\r\n        <el-button type=\"primary\" @click=\"handleAddMember\">添加成员</el-button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.main-content {\r\n  flex: 1;\r\n  width: 1720px;\r\n  height: 765px;\r\n  margin: 0 auto;\r\n  margin-bottom: 10px;\r\n  background: #f5f7fa;\r\n  padding: 20px;\r\n}\r\n.member-page {\r\n  display: flex;\r\n  padding: 20px;\r\n  gap: 30px;\r\n}\r\n\r\n.left-table {\r\n  flex: 3;\r\n}\r\n\r\n.right-form {\r\n  flex: 1;\r\n  background: #f9f9f9;\r\n  padding: 20px;\r\n  border-radius: 6px;\r\n  border: 1px solid #e4e4e4;\r\n}\r\n</style>\r\n"],"mappings":"AACA,SAAQA,GAAG,EAAEC,SAAS,QAAO,KAAK;AAClC,SAAQC,QAAQ,EAACC,SAAS,QAAO,YAAY;AAC7C,SAAQC,SAAS,EAAEC,YAAY,QAAO,cAAc;AACpD,SAAQC,UAAU,EAAEC,SAAS,EAAEC,SAAS,QAAO,eAAe;;AAE9D;;;;;;;;IACA,MAAMC,KAAK,GAAGP,QAAQ,CAAC,CAAC;IACxB,MAAMQ,SAAS,GAAGD,KAAK,CAACE,MAAM,CAACC,EAAE;IAEjC,MAAMC,OAAO,GAAGb,GAAG,CAAC,EAAE,CAAC;IACvB,MAAMc,OAAO,GAAGd,GAAG,CAAC,KAAK,CAAC;IAE1B,MAAMe,MAAM,GAAGZ,SAAS,CAAC,CAAC;IAG1B,MAAMa,IAAI,GAAGhB,GAAG,CAAC;MACfiB,UAAU,EAAEP,SAAS;MACrBQ,QAAQ,EAAE,EAAE;MACZC,WAAW,EAAE;IACf,CAAC,CAAC;IAEF,MAAMC,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/BN,OAAO,CAACO,KAAK,GAAG,IAAI;MACpB,IAAI;QACF,MAAMC,GAAG,GAAG,MAAMhB,UAAU,CAACI,SAAS,CAAC;QACvCG,OAAO,CAACQ,KAAK,GAAGC,GAAG,CAACC,IAAI,IAAI,EAAE;MAChC,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZpB,SAAS,CAACqB,KAAK,CAACD,GAAG,CAACE,GAAG,IAAI,UAAU,CAAC;MACxC,CAAC,SAAS;QACRZ,OAAO,CAACO,KAAK,GAAG,KAAK;MACvB;IACF,CAAC;IAED,MAAMM,eAAe,GAAG,MAAAA,CAAA,KAAY;MAClC,IAAI,CAACX,IAAI,CAACK,KAAK,CAACH,QAAQ,IAAI,CAACF,IAAI,CAACK,KAAK,CAACF,WAAW,EAAE;QACnDf,SAAS,CAACwB,OAAO,CAAC,SAAS,CAAC;QAC5B;MACF;MAEA,IAAI;QACF,MAAMrB,SAAS,CAAC;UACdU,UAAU,EAAEP,SAAS;UACrBQ,QAAQ,EAAEF,IAAI,CAACK,KAAK,CAACH,QAAQ;UAC7BC,WAAW,EAAEH,IAAI,CAACK,KAAK,CAACF;QAC1B,CAAC,CAAC;QACFf,SAAS,CAACyB,OAAO,CAAC,QAAQ,CAAC;QAC3Bb,IAAI,CAACK,KAAK,CAACH,QAAQ,GAAG,EAAE;QACxBF,IAAI,CAACK,KAAK,CAACF,WAAW,GAAG,EAAE;QAC3BC,YAAY,CAAC,CAAC;MAChB,CAAC,CAAC,OAAOI,GAAG,EAAE;QACZpB,SAAS,CAACqB,KAAK,CAACD,GAAG,CAACE,GAAG,IAAI,QAAQ,CAAC;MACtC;IACF,CAAC;IAED,MAAMI,YAAY,GAAIC,SAAS,IAAK;MAClC1B,YAAY,CAAC2B,OAAO,CAChB,WAAW,EACX,IAAI,EACJ;QACEC,iBAAiB,EAAE,IAAI;QACvBC,gBAAgB,EAAE,IAAI;QACtBC,IAAI,EAAE;MACR,CACJ,CAAC,CAACC,IAAI,CAAC,YAAY;QACjB,IAAI;UACF,MAAM5B,SAAS,CAACuB,SAAS,CAAC;UAC1B3B,SAAS,CAACyB,OAAO,CAAC,MAAM,CAAC;UACzBT,YAAY,CAAC,CAAC;QAChB,CAAC,CAAC,OAAOI,GAAG,EAAE;UACZpB,SAAS,CAACqB,KAAK,CAACD,GAAG,CAACE,GAAG,IAAI,MAAM,CAAC;QACpC;MACF,CAAC,CAAC,CAACW,KAAK,CAAC,MAAM,CACf,CAAC,CAAC;IACJ,CAAC;IAEDpC,SAAS,CAAC,MAAM;MACdmB,YAAY,CAAC,CAAC;IAChB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}